<html>

<head>
  <link rel="stylesheet" type="text/css" href="styles.css" />
</head>

<body>
  <!-- <input type="button" name="play" value="Play" id="play" style="width:40px; height:20px" onclick="myFunction()" /> -->
  <div id="player1" class="resize-div"></div>


  <!-- COMMENTED CODE FOR TESTING OF MULTIPLE CAMERA VIEWS -->
  <!-- <div id="player2"></div>
  <div id="player3"></div>
  <div id="player4"></div> -->

  <webview id="foo" src="http://192.168.0.109/zygal/home.php" nodeintegration style="width:100%;height:100%">
    <script>
      const env = require('./global_env.js');
      const customTitlebar = require('@inceldes/cet');
      dragElement(document.getElementById("player1"));
      /* COMMENTED CODE FOR TESTING OF MULTIPLE CAMERA VIEWS */
      // dragElement(document.getElementById("player2"));
      // dragElement(document.getElementById("player3"));
      // dragElement(document.getElementById("player4"));

      function dragElement(elmnt) {
        console.log("Elmnt", elmnt);
        var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;
        if (document.getElementById(elmnt.id)) {
          console.log("document", document.getElementById(elmnt));
          console.log("111", document.getElementById(elmnt.id).onmousedown);
          document.getElementById(elmnt.id).onmousedown = dragMouseDown;
        } else {
          elmnt.onmousedown = dragMouseDown;
        }

        function dragMouseDown(e) {
          console.log("E", e);
          e = e || window.event;
          e.preventDefault();
          pos3 = e.clientX;
          pos4 = e.clientY;
          document.onmouseup = closeDragElement;
          document.onmousemove = elementDrag;
        }

        function elementDrag(e) {
          console.log("e", e);
          e = e || window.event;
          e.preventDefault();
          pos1 = pos3 - e.clientX;
          pos2 = pos4 - e.clientY;
          pos3 = e.clientX;
          pos4 = e.clientY;
          elmnt.style.top = (elmnt.offsetTop - pos2) + "px";
          elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";
        }

        function closeDragElement() {
          console.log("close");
          document.onmouseup = null;
          document.onmousemove = null;
        }
      }

      // Menu.getApplicationMenu()
      new customTitlebar.Titlebar({
        backgroundColor: customTitlebar.Color.fromHex(env.titleBarColor),
        menu: false,
        drag: true,
        maximizable: true,
        minimizable: true,
        icon: env.icon
      });
      /* COMMENTED CODE FOR TESTING OF MULTIPLE CAMERA VIEWS */
      // var player2 = new wjs("#player2").addPlayer(conf);
      // var player3 = new wjs("#player3").addPlayer(conf);
      // var player4 = new wjs("#player4").addPlayer(conf);
      var conf = {
        wcjs: require('wcjs-prebuilt'),
        multiscreen: true,
        autoplay: true,
        loop: true
      };

      var wjs = require("wcjs-player");
      const webview = document.querySelector('webview')
      webview.addEventListener('ipc-message', (event) => {
        // document.write(" <div id='player1'></div>");
        var player1 = new wjs("#player1").addPlayer(conf);
        console.log(event.channel);
        console.log(event.args[0]);
        play(player1);
        // play(player2);
        // play(player3);
        // play(player4);
        webview.send("msgFromElectron", "pinggggggggggg");
      });

      function play(player) {
        player.addPlaylist("file:///C:/Users/Public/Videos/Sample Videos/Wildlife.wmv");
        crop: "16:9";
      }
    </script>
</body>

</html>